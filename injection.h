#ifndef INJECTION_H
#define INJECTION_H

#include <Windows.h>

// Returns a handle to process specified by name
// Upon an error, will return NULL
// Parameters:
//	- IN LPCSTR targetProcessName: name of remote process
//
HANDLE GetTargetHandle(IN LPCSTR targetProcessName);

// Writes a given payload to first available memory region in remote process
// Upon an error, will return NULL
// Parameters:
//	- IN HANDLE hProcess: process to inject code into
//	- IN UCHAR* cShellcode: shellcode to inject
//	- IN SIZE_T szShellcode: size of shellcode without null-terminator
// 
// Returns a pointer to allocated buffer storing payload
//
LPVOID WriteShellcode(IN HANDLE hProcess, IN UCHAR* cShellcode, IN SIZE_T szShellcode);

// Executes shellcode at given memory buffer in target process
// Upon success, returns TRUE. Otherwise, returns FALSE.
// Parameters:
//	- IN HANDLE hProcess: Handle to target process
//	- IN LPVOID pBuffer: Pointer to allocated buffer
//
BOOL Execute(IN HANDLE hProcess, IN LPVOID pBuffer);

#endif