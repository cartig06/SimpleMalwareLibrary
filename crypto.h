#ifndef CRYPTO_H
#define CRYPTO_H

#include <Windows.h>

enum class Algorithm {
	XOR = 0,
	AES = 1
};

class Payload {
private:
	UCHAR* payload;
	SIZE_T szPayload;
	int algorithm;          // Set constants for types
	UCHAR* bKey;
	SIZE_T szKey;
	UCHAR* iv;      // Initialization Vector
public:
	Payload(UCHAR* data, SIZE_T dataSize, int alg, UCHAR* key, SIZE_T keySize, UCHAR* initVector)
		: payload(nullptr), szPayload(0), algorithm(alg), bKey(nullptr), szKey(0), iv(nullptr) {
		
		payload = new UCHAR[dataSize];
		memcpy(payload, data, dataSize);
		szPayload = dataSize;

		bKey = new UCHAR[keySize];
		memcpy(bKey, key, keySize);
		szKey = keySize;

		iv = initVector;
	}

	BOOL Decrypt();

	BOOL Encrypt();

	BOOL Destroy();
};

#endif