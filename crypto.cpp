#include "crypto.h"
#include <iostream>

// TODO: Implement AES decryption, add encrypt() logic, add destroy() logic.

BOOL Payload::Decrypt() {
	if (payload == nullptr || szPayload == 0 || bKey == nullptr || szKey == 0) {
		std::cerr << "[-] Failed to validate one or more parameters of payload object." << std::endl;
		return FALSE;
	}
	switch (algorithm) {
	case XOR:
		for (int i = 0, j = 0; i < szPayload; i++, j++) {
			if (j >= szKey) j = 0;
			payload[i] = payload[i] ^ (i + bKey[j]);
		}

		return TRUE;

	case AES:
		; // TODO: Implement AES decryption here
	}

	std::cerr << "[-] Invalid algorithm detected. Review crypto.h for usage details" << std::endl;
	return FALSE;
}

BOOL Payload::Encrypt() {
	; // TODO: add encrypt() logic here
}

BOOL Payload::Destroy() {
	; // TODO: add destroy() logic
}